## Results

Both MCMC convergence and effective sample size of the different jSDMs were satisfactory (see Appendix D).

### Model Fit & Predictive power

#### Species level

Presence/absence models showed excellent explanatory power with mean AUC > 0.9 on training data, but low predictive power with mean AUC ~ 0.66 on test data. Abundance models had a mean RMSE of 8.83 to 9 on the training set, and they underpredicted abundances (Fig. S9). Predictive power varied among models, with the WhC model performing best in order of magnitude ($\text{mean RMSE} =6.26$), followed by the Bench model ($\text{mean RMSE} = 123$), the Ph model ($\text{mean RMSE} = 61.58$), and the traits & phylogeny model ($\text{mean RMSE} =139.79$; Fig. S4). Most models underpredicted species abundance in the test dataset (Fig. S10; Table S1). Compared to the benchmark model (Fig. 2), the TrPh and Ph models slightly decreased in explanatory power (+0.3% and +1.2% increase in RMSE, respectively; -0.6% decrease in AUC for both models). The WhC models showed a slight increase in explanatory power (-2.5% decrease in RMSE; +0.3% increase in AUC). The WhC abundance model performed better in predictive power, with a 16.6% decrease in RMSE compared to the benchmark model. This improvement was observed in 58 species (mean decrease in RMSE of -53.6%; 10th and 90th deciles [-10.3%, -97.6%]), while 16 species showed decreased performance (+92% mean RMSE; 10th and 90th deciles [2.7%, 52.4%]). Across all species, the Ph and TrPh models had a mean relative increase in RMSE of 40% and 70%, respectively. Only 29 and 38 species were improved for TrPH and Ph models, with a mean decrease in RMSE of 34.4% and 35%, respectively. Finally, the model's explanatory performance improved for common species (correlation between RMSE and proportion of presence: Kendall's τ = -0.28, p-value < 1e-5) and abundant species (correlation between RMSE and average species abundance: Kendall's τ = -0.29, p-value < 1e-4).

<!-- ![Relative change in explanatory and predictive power of model structures (purple for benchmark (Bench), yellow for phylogeny (Ph), red for traits & phylogeny (TrPh), and green for whole community (WhC) models). Changes expressed as % relative to the benchmark fitted on presence/absence (top row) or abundance (bottom row) data. Points above the zero line indicate performance gain.](figures/fig2.png){#fig:fig2} -->

#### Community level

On the training dataset, the mean differences in Bray-Curtis dissimilarity between observed and predicted abundance data ranged from -0.042 to -0.061 (sd 0.136 to 0.142). On the test dataset, the range was 0.16 to 0.20 (sd 0.16 to 0.19; Fig. S15). Similar results were found for Sørensen dissimilarity index computed on presence/absence data (Fig. S16). Except for the WhC model, all models fitted with abundance data underpredicted richness compared to the observed community. On the training dataset, the mean difference in richness ranged from -4.13 to -4.02 (sd 3.65 to 3.85). On the test dataset, the range was -5.49 to -4.71 (sd 7.90 to 8.60). The WhC model tended to overpredict richness, with an average mean difference of 10.9 (sd 10.9) on the training dataset and 7.11 (sd 11.8) on the test dataset (Fig. S15). Similar results were found for models fitted with occurrence data (Fig. S16). Furthermore, the WhC model underpredicted abundance on both the training and test datasets (mean differences in abundance -22 and -404, sd 450 and 729, respectively). On the other hand, all other models underpredicted abundances on the training dataset (mean differences ranging from -159 to -152, sd ranging from 429 to 434), but greatly overpredicted abundances on the test dataset (ranging from 505 to 2005, sd ranging from 4868 to 12653; Fig. S15). These results indicate that predicted communities are relatively similar to observed communities. The WhC model compensates for its errors in richness by having smaller errors in abundances, while the other three models show the opposite pattern.

<!-- ![Comparison of model performances with regards to their ability to predict community structures when fitted with abundance data for the train (purple) and test (yellow) dataset. The left column indicates for each model the difference between the pairwise dissimilarities computed on the observed assemblages and those computed on the predicted one. The middle column presents the differences in species richness between the observed and predicted assemblages. The right column presents the differences in total abundance between the observed and predicted assemblages.](figures/fig3.png){#fig:fig3} -->

### Variance partitioning

The amount of variance explained by each model can be partitioned between environmental covariates and random effects. For all models, environmental variables account for most (more than 70% ± 21%, mean ± s.d.) of the variance (Fig. S13). However, a larger part of variance is explained by random effects in the WhC model compared to the Bench model (Fig. S13). Relative to the Bench model, the median relative change in variance explained by random effects decrease by 14.8% for the Ph model, 16.9% for the TrPh model and increase by 145% for the WhC model (+@fig:fig3). Similar results were obtained for presence/absence models (+@fig:fig3).

<!-- ![Relative change in variance explained by environmental predictors (left column) and random effects (right column) of model structures (purple for Benchmark (Bench), yellow for phylogeny (Ph), red for traits & phylogeny (TrPh), and green for whole community (WhC) models). Percentage change is relative to the benchmark model fitted with presence/absence (top panels) or abundance (bottom panels) data. Positive values indicate an increase in the proportion of variance explained by the focal model compared to the benchmark model.](figures/fig4.png){#fig:fig4} -->

### Species niche estimated

For abundance models, over 60% of response curves were flat, indicating a lack of meaningful species-environment relationships (+@fig:fig4). This proportion rose to 83% for the WhC model. Convex or concave response curves were rare in abundance models. Meaningful relationships primarily included constant or accelerated declines, representing approximately 10% and 15% of response curves in the three models without the whole community (Bench, TrPh, and Ph) (+@fig:fig4). In the WhC model, these percentages decreased to 7% and 6%, respectively (+@fig:fig4). Similar findings were observed for presence/absence models (Fig. S17).

<!-- ![Number (y-axis) and proportion (indicated above individual bars) of response curves (i.e. one for each species-predictor combination) according to the nomenclature (nine shapes highlighted by the black curve in each panel) defined by @Rigal_2020 for different abundance model structures. See Fig. S10 for a similar representation for presence-absence models.](figures/fig5.png){#fig:fig5} -->

Both abundance- and presence/absence TrPh models (which include species functional traits) reveal some meaningful trait-environment relationships between the first fuzzy-PCA axis and the seven environmental predictors. This suggests that the occurrence of certain traits is likely favoured (or hindered) under certain environmental conditions (Fig. S11). For instance, mobile predatory species were more negatively affected by fetch than sessile suspensivores (Fig. S11). Moreover, increase in organic matter concentration and decrease in current velocities were associated with higher abundances of suspensivore populations.

### Exploring the residual correlation

Residual correlations were compared between the Bench model and the WhC model, using both presence/absence and abundance data. The WhC model was chosen for this comparison due to its superior performance and higher proportion of explained variance by random effects (+@fig:fig3). Residual correlations estimated by the WhC model were similar to those of the Bench model, regardless of whether presence/absence or abundance data were used (+@fig:fig5 and Fig. S22). However, the agreement between models varied across different random effects. When comparing residuals between Bench and WhC models fitted on abundance data, the correlation was low for random site effects ($\text{R}^2 = 0.01$), moderate for random habitat effects ($\text{R}^2 = 0.29$), and high for random year effects ($\text{R}^2 = 0.79$).

<!-- ![(A) Comparison of residual correlations associated with the three random effects estimated by the Whole Community Model (y-axis) and the Benchmark model (x-axis) fitted on abundance data. The colour scale highlights the density of points in each scatter plot. (B) Distribution of the index measuring change in sign (sign change left to the zero line, no change to the right) and magnitude (higher departure from the zero line indicate higher difference) between residual correlations estimated by the whole community model and the benchmark model adjusted with abundance data for the three random effects (Habitat, Site, Year).](figures/fig6.png){#fig:fig6} -->

The index main modal distribution, which is centred on zero, suggests an overall agreement between residual correlations obtained from both models (+@fig:fig5 and Fig. S22). The index highlight most important variation for the magnitude of theyear random effect. Besides, our index indicates sign consistency in residual correlations between the two models. Similar results were obtained for presence/absence models.

## Discussion

Case studies in community ecology typically rely on partial and heterogeneous observations [@Pollock_2020] but also on incomplete knowledge of target species ecological features (e.g. traits, phylogeny; @Troudet_2017). In this paper we investigated how jSDM performance varies depending on the type of information included (i.e. phylogeny, traits or data on non-target species). While jSDMs have two main goals, i.e. explaining and predicting species distribution and community composition across space and/or time [@Tredennick_2021], they have mostly been tested with regards to their predictive power [@Norberg_2019], and to some extent in terms of parameter estimates [@Wilkinson_2020], but manly when fitted on presence/absence data [@Norberg_2019 ; @Wilkinson_2020]. Yet, jSDMs are increasingly fitted on abundance data [@Brimacombe_2020] and for explanatory purposes [@Abrego_2016]. Hence, there is a mismatch between current understanding of jSDMs performance and their application by ecologists. Here, we consolidate the assessment of jSDMs performance using complementary metrics and evaluation methods. We characterise how  different aspects of model performances vary with changes in model structure related to the type of information considered, which can affect interpretability and conclusions drawn from these models.

We found that jSDM’s performance, in particular predictive power of abundance models, most increased when including information related to the 179 non-target species sampled alongside with the 99 polychaete species of interest. Given HMSC hierarchical structure [@Poggiato_2021], inclusion of monitoring data related to other species likely improves model performance for the target assemblage by capturing relevant drivers that are not explicitly considered. For instance, inclusion of monitoring data for other species can help describe target species' realised niche by accounting for  ecological processes related to  environmental conditions (including trait-mediated responses) or biotic interactions that are not explicitly captured otherwise [@Ovaskainen_2017a]. In jSDMs, unquantified ecological processes can be estimated using latent variables from model residual correlation matrix. While this feature of jSDMs originally yielded the potential to capture biotic interactions, it is now well-established that potential biotic signals captured by jSDMs are largely confounded by other factors. These include missing environmental variables [@Dormann_2018 ; @Zurell_2018 ; @Blanchet_2020], scale mismatch between study organism responses and available environmental variables [@Potter_2013], coarse spatial resolution of environmental variables [@Konig_2021].

Importantly, while including non-target species improved predictive performance in our case study,  benefits of accounting for non-target species might vary depending on robustness of non-target species monitoring data (e.g. detection issues), their role within the ecosystem (e.g. engineer species are likely more influential on local communities than rare transient species), or processes shaping the target assemblage (if influence of abiotic factors dominates, then adding other species will have marginal consequences on model performance). Of course, in the case of a well known ecological system, it would be possible to easily narrow down the list of species to be recorded. But in many cases, there is no information available to establish such a list. Furthermore, a specific investigation would be required to determine the optimal number of non-target species to include :  for instance using simulated datasets to overcome limitations related to real world datasets [@DiRenzo_2022]. While species communities and assemblages are largely defined arbitrarily [@Stroud_2015], A systematic assessment of jSDM performance as increasing number of non-target species, across different functional or trophic roles would be valuable to delineate which ecological units to include (or not) to improve model performance for the species of management/conservation interests.

In practice, ecological studies often focus on a certain guild or taxonomic group (e.g. fish, birds) given data collection (consistent sampling methodology) or availability constraints (traits and/or phylogeny biased toward some taxonomic groups, @Tyler_2012 and usually centralised in taxonomic-centred repositories [e.g. FishBase; eBird]), rather than for ecological reasons (e.g. all potential interactions well captured by the data at hand). In this study, dedicated focus on polychaetes was primarily guided by data availability (species-traits matrices available from @Boye_2019a only included polychaetes) rather than for ecological reasons, although the fact that this taxonomic group is numerically dominant and highly diverse in terms of lifestyles and functional roles [@Jumars_2015 ; @Giangrande_1997] was the reason that originally motivated trait-data collection.

jSDMs have already been used to model the distribution of a wide variety of species ranging from micro-organisms [@Minard_2019] to megafauna [@Brimacombe_2020] inhabiting many different ecosystems. Here, while we studied communities associated with two specific coastal habitats, i.e. seagrass and sand, that have original characteristics as they are located at the land-sea interface [@Boye_2019a], our case study reflects typical aspects of applied ecological research. These include issues related to data limitation and availability but also typical features of ecological communities (e.g. prevalence of rare and transient species; @Magurran_2003 ; @SnellTaylor_2018). Our results provide some insights on trait-environment relationships but these contributions of functional ecology in jSDMs are likely limited by trait data quality and availability [@Tyler_2012 ; @deJuan_2022]. For instance, we found an interaction between trophic modalities (i.e. microphagous versus macrophagous diet) and fetch (Fig. S15), indicating that organisms that filter on small particles are less likely to occur in wave-exposed sites where high levels of sediment resuspension can block their filtering systems [@Manning_2014]. Conversely macrophagous organisms are less impacted by fetch. Yet, most trait-environment relationships, and most species-environment relationships were flat suggesting that polychaete assemblages are driven by processes other than abiotic ones, including neutral processes [@Boye_2019a]. However, the lack of contribution of other trait-environment relationships in our model could also be related to a mismatch between trait data, environmental data, and the ecological processes at play [@deJuan_2022]. For instance, the physical coastal environment is highly dynamic; a feature that is only partially characterised by our environmental variables that summarise average climatological conditions (but not extreme events or annual/seasonal variability). Likewise, the list of available fuzzy-coded traits only partially captures species capacity to adapt to frequent disturbances or environmental variability [@deJuan_2022]. Most ecological studies are likely to face similar trade-offs where the potential benefit of including traits within jSDMs is balanced out by the effort needed to collect relevant trait information when missing. In our case, while including traits does not improve model predictive power, it enhances our  understanding of species responses along environmental gradients. Hence, if the goal is not prediction but inference [@Tredennick_2021], including traits and proxies of phylogeny can facilitate model interpretation, providing that explanatory power does not decrease (as in our case), and that additional model parameters do not make computation time impractical.

While guidelines have been developed to characterise the performance of jSDM fitted on  presence-absence data [@Wilkinson_2020], it is only recently that the predictive power of abundance-based models has been explored [@Waldock_2022]. Here, we used a set of complementary metrics to assess the performance of both presence-absence and abundance models at the species and community levels, the latter considering both alpha and beta diversity. We also transposed a method initially developed for time series [@Rigal_2020] to provide an innovative way of characterising the response curves of each species. Further, we bring together a set of approaches and propose a new index to characterise and compare residual correlation matrices. Overall, we provide a comprehensive framework for integrative assessment and comparison of alternative jSDM performance.

Overall, our results provide new insights into the most appropriate strategies for jSDM fitting, according to modelling objectives [@Troudet_2017] and available data. While the four  models considered had similar explanatory power, adding extra information to traditional jSDMs that only consider abiotic predictors can prove useful in cases. For instance, adding monitoring data for other non-target species can substantially increase model predictive power by modifying inferred species-environment relationships and residual correlation matrices. Similarly, adding traits or phylogeny can improve model interpretability. Future studies will be key to consolidate our findings on simulated case studies [@Zurell_2010 ; @DiRenzo_2022], or across contrasted ecosystems, for instance dominated either by environmental filtering, or by competitive processes. For these purpose, we recommend using a multi-model inference framework similar to the one used in this study.

